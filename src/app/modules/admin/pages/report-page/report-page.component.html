
<section class="report-main">
  <app-head title="Espacio reportes"></app-head>
  <div class="report-section-body">
    <mat-tab-group>
      <mat-tab label="Ingresos por Propiedad">
        <h3 class="report-title">Informe de Ingresos por Propiedad</h3>
        <table
          mat-table
          [dataSource]="incomeReport"
          class="report-section-table"
        >
          <ng-container matColumnDef="propertyId">
            <th mat-header-cell *matHeaderCellDef>Nro de Referencia</th>
            <td mat-cell *matCellDef="let element">{{ element.propertyId }}</td>
          </ng-container>
          <ng-container matColumnDef="propertyName">
            <th mat-header-cell *matHeaderCellDef>Nombre de Propiedad</th>
            <td mat-cell *matCellDef="let element">
              {{ element.propertyName }}
            </td>
          </ng-container>
          <ng-container matColumnDef="income">
            <th mat-header-cell *matHeaderCellDef>Ingresos Totales</th>
            <td mat-cell *matCellDef="let element">
              {{ element.income | currency }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
        <p style="margin-top: 20px; font-style: italic; text-align: center">
          Nota: Las Propiedades no visualizadas indica que no generaron ingresos
        </p>
        <button (click)="downloadTableAsExcel(incomeReport.data, displayedColumns, 'Ingresos_por_Propiedad')">Descargar como Excel</button>
      </mat-tab>
      <mat-tab label="Ingresos por tipo de pago"
        ><h3 class="report-title">Informe de ingresos por tipo de pago</h3>
        <table
          mat-table
          [dataSource]="incomeReport2"
          class="report-section-table"
        >
          <ng-container matColumnDef="paymentType">
            <th mat-header-cell *matHeaderCellDef>Tipo de Pago</th>
            <td mat-cell *matCellDef="let element">
              {{ element.paymentType }}
            </td>
          </ng-container>
          <ng-container matColumnDef="income">
            <th mat-header-cell *matHeaderCellDef>Ingresos</th>
            <td mat-cell *matCellDef="let element">
              {{ element.income | currency }}
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns2"></tr>
        </table>
        <p style="margin-top: 20px; font-style: italic; text-align: center">
          Nota: Los tipos de pagos no visualizados indica que no generaron
          ningun ingreso
        </p>
        <button (click)="downloadTableAsExcel(incomeReport2.data, displayedColumns2, 'Ingresos_por_tipo_de_pago')">Descargar como Excel</button>
      </mat-tab>
      <mat-tab label="Ingresos por clientes">
        <h3 class="report-title">Informe de ingresos x clientes</h3>
        <mat-table
          [dataSource]="clientIncomeReport"
          class="report-section-table"
        >
          <ng-container matColumnDef="clientName">
            <th mat-header-cell *matHeaderCellDef>Cliente</th>
            <td mat-cell *matCellDef="let element">{{ element.clientName }}</td>
          </ng-container>
          <ng-container matColumnDef="income">
            <th mat-header-cell *matHeaderCellDef>Ingresos</th>
            <td mat-cell *matCellDef="let element">
              {{ element.income | currency }}
            </td>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns3"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns3"></mat-row>
        </mat-table>
        <p style="margin-top: 20px; font-style: italic; text-align: center">
          Nota: Los clientes no visualizados indica que no han realizado ningun
          cobro aún
        </p>
        <button (click)="downloadTableAsExcel(clientIncomeReport.data, displayedColumns3, 'Ingresos_por_clientes')">Descargar como Excel</button>
      </mat-tab>
      <mat-tab label="Ingresos por duración de reserva">
        <h3 class="report-title">
          Informe de ingresos por duración de reserva
        </h3>
        <table
          mat-table
          [dataSource]="incomeReport3"
          class="report-section-table"
        >
          <ng-container matColumnDef="duration">
            <th mat-header-cell *matHeaderCellDef>
              Duración de reservas (En días o semana)
            </th>
            <td mat-cell *matCellDef="let row">{{ row.duration }}</td>
          </ng-container>
          <ng-container matColumnDef="income">
            <th mat-header-cell *matHeaderCellDef>Ingresos</th>
            <td mat-cell *matCellDef="let row">{{ row.income | currency }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns4"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns4"></tr>
        </table>
        <button mat-button (click)="downloadTableAsExcel(incomeReport3.data, displayedColumns4, 'Ingresos_por_duracion_de_reserva')">
          <mat-icon>download</mat-icon> 
        </button>
      </mat-tab>
    </mat-tab-group>
  </div>
</section>
